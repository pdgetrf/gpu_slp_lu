#	makefile for high-level threading LU	#

CC = mpicc
FC = mpif77 

CFLAGS = -I/opt/mkl/include 
CFLAGS += -DCHECKPOINT
CFLAGS += -DVERIFY_CHK
CFLAGS += -DLOCALCOPY
#CFLAGS += -DTIMING
#FFLAGS =  -fsecond-underscore
#FFLAGS = -assume 2underscore

BLACSLIB =  -L/opt/mkl/lib/em64t -lmkl_scalapack_lp64 -lmkl_blacs_openmpi_lp64 -lmkl_lapack -lmkl_gf_lp64 -lmkl_sequential -lmkl_core  -lpthread -lm
#BLACSLIB =  -L/opt/mkl/lib/em64t -L/home/pdu/lib/scalapack-1.8.0 -lscalapack -lmkl_blacs_openmpi_lp64 -lmkl_lapack -lmkl_gf_lp64 -lmkl_sequential -lmkl_core  -lpthread -lm

LINKLIB =   qr_test.o pdgeqrrv.o pdmatgen.o pmatgeninc.o pdlaprnt.o orig_pdgeqrf.o ft_pdgeqrf0.o ft_pdgetrf.o ft_pdgeqrf.o ft_pdlarfb.o util_ft.o $(BLACSLIB)

PROG = qr_test.x

$(PROG) : qr_test.o pdgeqrrv.o pdmatgen.o pmatgeninc.o pdlaprnt.o util_ft.o orig_pdgeqrf.o ft_pdgetrf.o ft_pdgeqrf0.o ft_pdgeqrf.o ft_pdlarfb.o 
	$(FC) -nofor_main -o $(PROG) $(CFLAGS) $(LDFLAGS) $(LINKLIB) 

.c.o:
	$(CC) -c -O3 $(DEBUG) $(CFLAGS) $(LDFLAGS) $*.c

.f.o:
	$(FC) -c -O3 $(DEBUG) $(FFLAGS) $(LDFLAGS) $*.f 

clean:
	rm *.o *.x
